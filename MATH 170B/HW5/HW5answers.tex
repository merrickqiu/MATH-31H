\documentclass{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{hyperref}
\usepackage{indentfirst}
\usepackage{matlab-prettifier}
\usepackage[shortlabels]{enumitem}
\usepackage{graphicx}
\usepackage{physics}
\usepackage[margin=1in]{geometry}

%User defined commands
\newcommand{\inv}[1]{#1^{-1}}
\newcommand{\cond}{\kappa_{||\cdot||}}

\begin{document}
\begin{center}
	\huge{\bf Math 170B: Homework 5} \\
	Merrick Qiu
\end{center}

\section*{Problem 1}
Let $x_n = x+nh$ and $f_n = f(x_n)$ for convenience.
We can derive the first formula by interpolating $f(x)$ at $x_0, x_1, x_2, x_3$.
\begin{align*}
	&p(x) = f_0 + (x-x_0)f[x_0, x_1] + (x-x_0)(x-x_1)f[x_0, x_1, x_2] + (x-x_0)(x-x_1)(x-x_2)f[x_0, x_1, x_2, x_3] \\
    &p'''(x) = 6f[x_0,x_1,x_2,x_3] = 6\frac{f_3-3f_2+3f_1-f_0}{6h^3}
	= \frac{1}{h^3}[f(x+3h)-3f(x+2h) + 3f(x+h)-f(x)]
\end{align*}
Using Taylor series, we have that
\begin{align*}
	f(x_0) &= f(x_0) \\
	f(x_1) &= f(x_0) + f'(x_0)h + \frac{f''(x_0)}{2}h^2 + \frac{f'''(x_0)}{6}h^3 + \frac{f^{(4)}(x_0)}{24}h^4 + \frac{f^{(5)}(\xi(x_1))}{120}h^5 \\
	f(x_2) &= f(x_0) + 2f'(x_0)h + 2f''(x_0)h^2 + \frac{4f'''(x_0)}{3}h^3 + \frac{2f^{(4)}(x_0)}{3}h^4 + \frac{4f^{(5)}(\xi(x_2))}{15}h^5 \\
	f(x_3) &= f(x_0) + 3f'(x_0)h + \frac{9f''(x_0)}{2}h^2 + \frac{9f'''(x_0)}{2}h^3 + \frac{27f^{(4)}(x_0)}{8}h^4 + \frac{81f^{(5)}(\xi(x_1))}{40}h^5 \\
\end{align*}
Thus for some $\eta$,
\[
	f(x_3)-3f(x_2) + 3f(x_1)-f(x_0) = h^3f'''(x_0) + \frac{3}{2}f^{(4)}h^4 + \eta h^5
\]
So the error term is $O(h)$.

Similarly when we interpolate at $x_{-2}, x_{-1}, x_{1}, x_{2}$,
\begin{align*}
	&p(x) = f_{-2} + (x-x_{-2})f[x_{-2}, x_{-1}] + (x-x_{-2})(x-x_{-1})f[x_{-2}, x_{-1}, x_1] + (x-x_{-2})(x-x_{-1})(x-x_1)f[x_{-2}, x_{-1}, x_1, x_2] \\
    &p'''(x) = 6f[x_{-2},x_{-1},x_1,x_2] = 6\frac{f_2-2f_1+2f_{-1}-f_{-2}}{12h^3}
	= \frac{1}{2h^3}[f(x+2h)-2f(x+h) + 2f(x-h)-f(x-2h)]
\end{align*}
Using Taylor series, we have that
\begin{align*}
	f(x_{-2}) &= f(x_0) - 2f'(x_0)h + 2f''(x_0)h^2 - \frac{4f'''(x_0)}{3}h^3 + \frac{2f^{(4)}(x_0)}{3}h^4 - \frac{4f^{(5)}(\xi(x_{-2}))}{15}h^5 \\
	f(x_{-1}) &= f(x_0) - f'(x_0)h + \frac{f''(x_0)}{2}h^2 - \frac{f'''(x_0)}{6}h^3 + \frac{f^{(4)}(x_0)}{24}h^4 - \frac{f^{(5)}(\xi(x_{-1}))}{120}h^5 \\
	f(x_1) &= f(x_0) + f'(x_0)h + \frac{f''(x_0)}{2}h^2 + \frac{f'''(x_0)}{6}h^3 + \frac{f^{(4)}(x_0)}{24}h^4 + \frac{f^{(5)}(\xi(x_1))}{120}h^5 \\
	f(x_2) &= f(x_0) + 2f'(x_0)h + 2f''(x_0)h^2 + \frac{4f'''(x_0)}{3}h^3 + \frac{2f^{(4)}(x_0)}{3}h^4 + \frac{4f^{(5)}(\xi(x_2))}{15}h^5 \\
\end{align*}
Thus for some $\eta$,
\[
	f(x+2h)-2f(x+h) + 2f(x-h)-f(x-2h) = 2h^3f'''(x_0) + \eta h^5
\]
So the error term is $O(h^2)$. 
Since the error is better on the second formula, its more accurate
\newpage 

\section*{Problem 2}
The approximation is
\[
	f'(x) \approx \frac{1}{2h}[-3f(x) + 4f(x+h) - f(x+2h)].
\]
The taylor series 
\begin{align*}
	f(x_0) &= f(x_0) \\
	f(x_1) &= f(x_0) + f'(x_0)h + \frac{f''(x_0)}{2}h^2 + \frac{f'''(\xi(x_1))}{6}h^3  \\
	f(x_2) &= f(x_0) + 2f'(x_0)h + 2f''(x_0)h^2 + \frac{4f'''(\xi(x_2))}{3}h^3  \\
\end{align*}
Thus 
\[
	-3f(x) + 4f(x+h) - f(x+2h) = 2hf'(x_0) + \eta h^3
\]
The error term is therefore $O(h^2)$.
\newpage 

\section{Problem 3}
Note that
\[
	\frac{\partial}{\partial x_i} a^t x = a_i \qquad \frac{\partial}{\partial x_i \partial x_j} a^t x = 0 
\]
Thus 
\[
	\nabla f(x) = a \qquad \nabla^2 f(x) = 0
\]
\newpage 
\section*{Problem 4}
We have that for a positive semidefinite $Q$,
\[
	f(x) = \frac{1}{2}x^TQx + b^Tx.
\]


Note that 
\begin{align*}
	f(x_k + \alpha p_k) &= \frac{1}{2}(x_k + \alpha p_k)^TQ(x_k + \alpha p_k) + b^T(x_k + \alpha p_k) \\
	&= \frac{1}{2}x_k^TQx_k + \alpha x_k^TQp_k + \frac{1}{2}\alpha^2p_k^TQp_k + b^Tx_k + \alpha b^Tp_k.
\end{align*}
Thus 
\[
	\frac{d}{d \alpha}(f(x_k + \alpha p)) = x_k^TQp_k + \alpha p_k^TQp_k + b^Tp_k
\]
Since 
\[
	x_k^TQ + b^t = Q^tx_k + b = \nabla f_k.
\]
Since 
\[
	\frac{d}{d \alpha}(f(x_k + \alpha p_k)) = x_k^TQp_k + \alpha p_k^TQp_k + b^Tp_k = 0.
\]
We have that 
\[
	\alpha = -\frac{\nabla f_k^T p_k}{p_k^TQp_k}
\]
\newpage 

\section*{Problem 5}
Since for a matrix $M$
\[
	||Mx|| \leq ||M||\cdot ||x||
\]
We have that 
\[
	||x|| = ||B^{-1}Bx|| \leq ||B^{-1}|| ||Bx|| \implies 
	||Bx|| \geq \frac{||x||}{||B^{-1}||}
\]
From Cauchy Schwartz we have that 
\[
	\cos \theta_k = - \frac{\nabla f_k^T p_k}{||\nabla f_k||\cdot ||p_k||}
\]
We can choose $B_k$ to be a positive definite matrix matrix so that
\begin{align*}
	-\frac{\nabla f_k^T p_k}{||\nabla f_k||\cdot ||p_k||} &= \frac{p_k^T B_k p_k}{||p_k^T B_k||\cdot ||p_k||} \\
	&\geq \frac{p_k^T B_k p_k}{||B_k||\cdot ||p_k||^2} \\
	&= \frac{p_k^T B_k^{1/2} B_k^{1/2}p_k}{||B_k||\cdot ||p_k||^2} \\
	&= \frac{||B_k^{1/2}p_k||^2}{||B_k||\cdot ||p_k||^2} \\
	&= \frac{||p_k||^2}{||B_k^{-1/2}||^2 \cdot ||B_k||\cdot ||p_k||^2} \\
    &= \frac{1}{||B_k^{-1}|| \cdot ||B_k||} \\
	& \geq \frac{1}{M}
\end{align*}
\newpage 

\section*{Matlab}
\lstinputlisting[style=Matlab-editor]{SecDeriv.m}
\begin{verbatim}
>> SecDeriv(x, y)

ans =

  -15.5616
   -7.3800
   -6.9792
   -6.3176
   -5.2212
   -3.4280
   -0.4640
    4.4760
   12.4800
   25.7920
   47.7640
  139.4720
\end{verbatim}



\end{document}


